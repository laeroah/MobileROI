(function(){$(function(){var t,e,i,r;return r={},$(".right-bar .property .pages").hide(),$(".mobile .page-img").hide(),i=null,$(".left-bar .page-img").click(function(){var t;return t=$(this).data("page-id"),$(".mobile .page-img.current").removeClass("current").hide(),$(".mobile .page-img[data-page-id="+t+"]").addClass("current").show()}),$(".right-bar .property .pages select").change(function(){return null!=i&&$(i).hasClass("link")?(console.log("select chage value"),r[$(i).attr("id")]=""!==$(this).val()?$(this).val():null,console.log(r)):void 0}),t=function(t){return null!=i&&$(i).removeClass("current"),i=t,$(i).addClass("current"),e()},e=function(){return null!=i?($(".right-bar .property .pages select").val(""),$(i).hasClass("link")?($(".right-bar .property .pages").show(),$(".right-bar .property .pages select").val(r[$(i).attr("id")])):$(".right-bar .property .pages").hide()):void 0},$(".right-bar .property button.delete").click(function(){var t,e,r,n;return null!=i?(t=$(".mobile .page-img.current"),r=$(t).attr("project-id"),e=$(t).attr("data-page-id"),n=$(i).attr("id"),null!=n&&$.ajax({type:"DELETE",url:"/projects/"+r+"/pages/"+e+"/widgets/"+n+".json",contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(){},error:function(t){alert("Error - "+t.toString())}}),$(i).remove(),i=null):void 0}),$(".right-bar .property button.save").click(function(){var t,e,i;return t=$(".mobile .page-img.current"),i=$(t).attr("project-id"),e=$(t).attr("data-page-id"),$(".component",$(t)).each(function(){var t,n,o,a,s,l,g,c,p;return s=$(this).attr("id"),c=$(this).position().left,p=$(this).position().top,g=$(this).width(),n=$(this).height(),o="",l=1,$(this).hasClass("link")&&(o=r[s],l="link"),a=this,null!=s?(t={"widget[id]":s,"widget[page_id]":e,"widget[link]":o,"widget[description]":"","widget[name]":"","widget[x]":c,"widget[y]":p,"widget[width]":g,"widget[height]":n,"widget[widget_type]":l},console.log("page_id = "+e),$.ajax({type:"PUT",url:"/projects/"+i+"/pages/"+e+"/widgets/"+s+".json?format=json",data:t,contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(){},error:function(t){alert("Error - "+t.toString())}})):(t={"widget[page_id]":e,"widget[link]":o,"widget[description]":"","widget[name]":"","widget[x]":c,"widget[y]":p,"widget[width]":g,"widget[height]":n,"widget[widget_type]":l},$.ajax({type:"POST",url:"/projects/"+i+"/pages/"+e+"/widgets.json?format=json",data:t,contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(t){var e;return e=t.id,$(a).attr("id",e)},error:function(t){alert("Error - "+t.toString())}}))})}),$(".right-bar .components .component").click(function(){var e;if(!($(".mobile .page-img.current").length<1))return e=$(this).clone().appendTo(".mobile .page-img.current").css({position:"absolute",top:0,left:0}).draggable({containment:".mobile .page-img.current",scroll:!1,start:function(){return t(e)},stop:function(t,e){return console.log(e.position,e.size)}}).resizable({start:function(){return t(e)},stop:function(t,e){return console.log(e.position,e.size)}}).click(function(){return t(this)}),t(e)}),Object.keys(gon.widgets_hash).forEach(function(e){var i,r,n,o,a,s;for(s=gon.widgets_hash[e],o=[],r=0,n=s.length;n>r;r++)a=s[r],i=$(".right-bar .components .component").clone(),$(i).attr("id",a.id),i.appendTo(".mobile .page-img[data-page-id="+e+"]").css({position:"absolute",top:a.y,left:a.x,height:a.height,width:a.width}).draggable({containment:".mobile .page-img[data-page-id="+e+"]",scroll:!1,start:function(){return t(i)},stop:function(t,e){return console.log(e.position,e.size)}}).resizable({start:function(){return t(i)},stop:function(t,e){return console.log(e.position,e.size)}}).click(function(){return t(this)}),o.push(i.addClass(a.widget_type));return o})})}).call(this);